<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Subir Contenido - ZenStudio Minimalista</title>
  <link rel="stylesheet" href="principalP1.css">
  <link rel="stylesheet" href="principalP2.css">
  <link rel="stylesheet" href="fondos.css">
  <link rel="stylesheet" href="subirMinimalista.css">
  <link rel="icon" href="../IMAGENES/ZenStudioLogo.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body data-theme="dark">
  <div class="background-container">
    <div class="zen-interface">
      <header class="topbar">
        <div class="topbar-left">
          <h1>Subir Contenido</h1>
        </div>
        <div class="topbar-right">
          <a href="paginaprincipal.php" class="action-btn secondary-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left">
              <line x1="19" y1="12" x2="5" y2="12"></line>
              <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
            Volver
          </a>
        </div>
      </header>
      <main class="main-content">
        <?php if (isset($message)): ?>
          <div class="message <?php echo ($errorCount > 0) ? 'error' : 'success'; ?>">
            <?php echo $message; ?>
          </div>
        <?php endif; ?>

        <!-- Selector de tipo -->
        <div class="type-selector">
          <button class="type-btn active" data-type="fondos">游꿛 Fondos Animados</button>
          <button class="type-btn" data-type="sonidos">游꿧 Sonidos Ambientales</button>
        </div>

        <!-- Formulario Fondos -->
        <form action="subirContenido.php" method="POST" enctype="multipart/form-data" class="upload-form active" id="form-fondos">
          <input type="hidden" name="tipo" value="fondos">
          <div class="form-group">
            <label for="categoria-fondos">Categor칤a:</label>
            <select name="categoria" id="categoria-fondos" required class="form-select">
              <option value="Naturaleza">Naturaleza</option>
              <option value="Abstracto">Abstracto</option>
              <option value="Ciudad">Ciudad</option>
              <option value="Espacio">Espacio</option>
              <option value="Animaci칩n">Animaci칩n</option>
            </select>
          </div>
          <div class="form-group">
            <label>Archivos de Fondos</label>
            <div class="file-drop-area">
              <span class="file-msg">Arrastra y suelta los archivos aqu칤</span>
              <span class="file-btn">o selecciona archivos</span>
              <input type="file" name="archivos[]" id="archivos-fondos" multiple
                     accept=".gif,.webp,.apng,.mp4" required>
            </div>
          </div>
          <small>Formatos permitidos: GIF, WebP, APNG, MP4 (max 50MB c/u)</small>
          <div id="file-preview-fondos" class="file-preview"></div>
          <button type="submit" class="action-btn primary-btn">Subir Fondos</button>
        </form>

        <!-- Formulario Sonidos -->
        <form action="subirContenido.php" method="POST" enctype="multipart/form-data" class="upload-form" id="form-sonidos">
          <input type="hidden" name="tipo" value="sonidos">
          <div class="form-group">
            <label for="categoria-sonidos">Categor칤a:</label>
            <select name="categoria" id="categoria-sonidos" required class="form-select">
              <option value="Naturaleza">Naturaleza</option>
              <option value="Agua">Agua</option>
              <option value="Ciudad">Ciudad</option>
              <option value="Instrumental">Instrumental</option>
              <option value="Ambiental">Ambiental</option>
              <option value="Blanco">Ruido Blanco</option>
            </select>
          </div>
          <div class="form-group">
            <label>Archivos de Sonido</label>
            <div class="file-drop-area">
              <span class="file-msg">Arrastra y suelta los archivos aqu칤</span>
              <span class="file-btn">o selecciona archivos</span>
              <input type="file" name="archivos[]" id="archivos-sonidos" multiple
                     accept=".mp3,.wav,.ogg,.m4a" required>
            </div>
          </div>
          <small>Formatos permitidos: MP3, WAV, OGG, M4A (max 20MB c/u)</small>
          <div id="file-preview-sonidos" class="file-preview"></div>
          <button type="submit" class="action-btn primary-btn">Subir Sonidos</button>
        </form>

      </main>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const typeButtons = document.querySelectorAll('.type-btn');
      const forms       = document.querySelectorAll('.upload-form');

      typeButtons.forEach(btn => {
        btn.addEventListener('click', function() {
          const type = this.dataset.type;
          typeButtons.forEach(b => b.classList.remove('active'));
          this.classList.add('active');

          forms.forEach(form => {
            form.classList.remove('active');
            if (form.id === `form-${type}`) form.classList.add('active');
          });
        });
      });

      setupFilePreview('archivos-fondos',  'file-preview-fondos');
      setupFilePreview('archivos-sonidos','file-preview-sonidos');

      // L칩gica para el 치rea de drag and drop
      document.querySelectorAll('.file-drop-area').forEach(area => {
        area.addEventListener('dragover', (e) => {
          e.preventDefault();
          area.classList.add('dragover');
        });
        area.addEventListener('dragleave', () => {
          area.classList.remove('dragover');
        });
        area.addEventListener('drop', () => {
          area.classList.remove('dragover');
        });
      });
    });

    function setupFilePreview(inputId, previewId) {
      const fileInput   = document.getElementById(inputId);
      const filePreview = document.getElementById(previewId);
      const handleFiles = (e) => {
        filePreview.innerHTML = '';
        const files = Array.from(e.target.files);
        files.forEach(file => {
          const previewItem = document.createElement('div');
          previewItem.className = 'preview-item';
          const url = URL.createObjectURL(file);

          if (file.type.startsWith('image/')) {
            const img = document.createElement('img');
            img.src = url;
            previewItem.appendChild(img);
          } else if (file.type.startsWith('video/')) {
            const video = document.createElement('video');
            video.src = url; video.muted = true; video.autoplay = true; video.loop = true;
            previewItem.appendChild(video);
          } else if (file.type.startsWith('audio/')) {
            const icon = document.createElement('div');
            icon.className = 'audio-icon';
            icon.innerText = '游꿧';
            icon.style.fontSize = '2rem';
            icon.style.textAlign = 'center';
            icon.style.padding = '20px';
            previewItem.appendChild(icon);
          }

          const info = document.createElement('div');
          info.className = 'preview-info';
          info.innerHTML = `
            <strong>${file.name}</strong>
            <div>${(file.size / 1024 / 1024).toFixed(2)} MB</div>
          `;
          previewItem.appendChild(info);
          filePreview.appendChild(previewItem);
        });
      };

      fileInput.addEventListener('change', handleFiles);
    }
  </script>
</body>
</html>