/* Variables y Reset */
:root{
    --clr-primary: #5882FA;
    --clr-accent: #E84C3C;
    --clr-highlight: #A3A3A3;

    --clr-background-light: #f7f9fb;
    --clr-panel-light: rgba(255,255,255,0.75);
    --clr-border-light: rgba(0,0,0,0.08);
    --clr-text-light: #212121;
    --clr-text-muted-light: #757575;
    --clr-hover-light: rgba(0,0,0,0.03);

    --clr-background-dark: #121212;
    --clr-panel-dark: rgba(30,30,30,0.75);
    --clr-border-dark: rgba(255,255,255,0.08);
    --clr-text-dark: #E0E0E0;
    --clr-text-muted-dark: #B0B0B0;
    --clr-hover-dark: rgba(255,255,255,0.04);

    --clr-background: var(--clr-background-light);
    --clr-panel: var(--clr-panel-light);
    --clr-border: var(--clr-border-light);
    --clr-text: var(--clr-text-light);
    --clr-text-muted: var(--clr-text-muted-light);
    --clr-hover: var(--clr-hover-light);

    --border-radius: 14px;
    --blur-strength: 14px;
    --transition-speed: 0.28s;
    --clr-soft-shadow: 0 10px 40px rgba(0,0,0,0.12);
    --clr-panel-shadow: 0 15px 50px rgba(0,0,0,0.14);
    --max-width: 1200px;
}

[data-theme="dark"]{
    --clr-background: var(--clr-background-dark);
    --clr-panel: var(--clr-panel-dark);
    --clr-border: var(--clr-border-dark);
    --clr-text: var(--clr-text-dark);
    --clr-text-muted: var(--clr-text-muted-dark);
    --clr-hover: var(--clr-hover-dark);
    --clr-soft-shadow: 0 10px 40px rgba(0,0,0,0.45);
    --clr-panel-shadow: 0 15px 50px rgba(0,0,0,0.6);
}

/* Base */
*{box-sizing:border-box}
html,body{height:100%}
body{
    margin:0;
    font-family:'Poppins',sans-serif;
    background:var(--clr-background);
    color:var(--clr-text);
    transition: background var(--transition-speed), color var(--transition-speed);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
}

/* Contenedor para el fondo de pantalla */
.background-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1; /* Detrás de todo */
    background-size: cover;
    background-position: center;
    transition: background-image 0.5s ease-in-out;
}

/* Layout */
.zen-interface{
    display:grid;
    grid-template-columns:80px 1fr;
    grid-template-rows:60px 1fr;
    height:100vh;
    gap:0;
}

/* Sidebar */
.sidebar{
    grid-row: 1 / 3;
    background:var(--clr-panel);
    border-right:1px solid var(--clr-border);
    backdrop-filter: blur(var(--blur-strength));
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:15px 0;
    gap:10px;
    z-index:20;
    box-shadow: var(--clr-soft-shadow);
}
.sidebar-nav{display:flex;flex-direction:column;gap:10px;flex-grow:1;width:100%;align-items:center}
.sidebar-btn{
    width:50px;height:50px;border-radius:12px;background:none;border:none;cursor:pointer;color:var(--clr-text-muted);
    display:flex;align-items:center;justify-content:center;
    transition: color .18s, background .18s, transform .18s, box-shadow .18s;
}
.sidebar-btn:hover{color:var(--clr-primary);background:var(--clr-hover)}
.sidebar-btn.selected{background:var(--clr-primary);color:#fff;box-shadow:0 6px 18px rgba(88,130,250,0.45)}
/* Micro-interacción de clic */
.sidebar-btn:active {
    transform: scale(0.92);
}

/* Topbar */
.topbar{
    grid-column:2/3;display:flex;justify-content:space-between;align-items:center;padding:0 20px;
    background:var(--clr-panel);border-bottom:1px solid var(--clr-border);backdrop-filter: blur(calc(var(--blur-strength) / 1.2));z-index:10;
}
.topbar-left{display:flex;align-items:center;gap:20px}

/* Focus dropdown */
.zenstudio-dropdown-container, .focus-dropdown-container{position:relative}
.focus-btn, .zenstudio-btn{background:none;border:none;color:var(--clr-text);font-size:1.05rem;font-weight:600;padding:6px 10px;border-radius:8px;cursor:pointer; display: flex; align-items: center; gap: 4px;}
.zenstudio-btn:hover, .focus-btn:hover{background:var(--clr-hover)}
.focus-menu{position:absolute;top:100%;right:0;background:var(--clr-panel);border:1px solid var(--clr-border);border-radius:10px;padding:8px 0;min-width:180px;box-shadow:var(--clr-soft-shadow);opacity:0;visibility:hidden;transform:translateY(10px);transition:all .28s}
.focus-menu.open{opacity:1;visibility:visible;transform:translateY(0)}
.focus-menu a{display:block;padding:8px 12px;text-decoration:none;color:var(--clr-text);transition:background .12s}
.focus-menu a:hover{background:var(--clr-hover);color:var(--clr-primary)}

/* --- Estilos para el nuevo menú de avatar --- */
.avatar-menu { min-width: 260px; padding: 0; }

/* Corrección para el menú de ZenStudio para que se alinee a la izquierda */
#zenstudio-menu {
    left: 0;
    right: auto;
}
.avatar-menu-profile {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px;
}
.menu-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
}
.menu-user-info { display: flex; flex-direction: column; }
.menu-user-name { font-weight: 700; font-size: 1rem; color: var(--clr-text); }
.menu-user-email { font-size: 0.85rem; color: var(--clr-text-muted); }
.menu-separator { height: 1px; background: var(--clr-border); margin: 0 8px; }
.avatar-menu a { padding: 12px 15px; }
/* --- Fin estilos menú avatar --- */

/* --- CIRUGÍA: Nombre de Usuario en topbar --- */

/* Convertimos el contenedor en flex para alinear texto e imagen */
.user-avatar-container {
    display: flex;
    align-items: center;
    gap: 12px; /* Espacio entre el nombre y la foto */
}

/*  Estilo del texto del nombre */
.topbar-username {
    font-weight: 600;         /* Letra un poco más gruesa */
    font-size: 0.95rem;       /* Tamaño sutil */
    color: var(--clr-text);   /* Usa el color de texto del tema actual */
    cursor: default;          /* El cursor no cambia, solo es etiqueta */
}

/* Responsividad: Ocultar el nombre en pantallas pequeñas (móviles) */
@media (max-width: 600px) {
    .topbar-username {
        display: none;
    }
}

/* Avatar & sound */
.sound-indicator{
    position: relative;
    width: 40px;
    height: 40px;
    background:none;
    border:none;
    color:var(--clr-text-muted);
    cursor:pointer;
    padding:0;
    transition:color .18s;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Icon state is based on mute status */
.sound-indicator:not(.muted) #sound-on-icon { opacity: 1; }
.sound-indicator:not(.muted) #sound-off-icon { opacity: 0; }
.sound-indicator.muted #sound-on-icon { opacity: 0; }
.sound-indicator.muted #sound-off-icon { opacity: 1; color: var(--clr-accent); }

/* Animation when audio is actually playing */
.sound-indicator.playing:not(.muted) {
    color: var(--clr-primary);
    animation: pulse 1.5s infinite ease-in-out;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

/* Aplicar la transición a los iconos de sonido */
#sound-on-icon,
#sound-off-icon { transition: opacity 0.35s ease; }

.topbar-right { display: flex; align-items: center; }
.user-avatar{
    width:38px;
    height:38px;
    border-radius:50%;
    object-fit: cover;
    aspect-ratio: 1 / 1;
    cursor:pointer;
    border: 2px solid var(--clr-border);
}

/* Main content */
.main-content{grid-column:2/3;grid-row:2/3;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;padding:20px}

/* Spaces */
/* Estilo para el mensaje de bienvenida */
#welcome-message {
    position: relative; /* Para posicionar el botón de cierre */
    max-width: 700px;
    width: 100%;
    padding: 60px 40px;
    border-radius: var(--border-radius);
    background: var(--clr-panel);
    border: 1px solid var(--clr-border);
    backdrop-filter: blur(var(--blur-strength));
    box-shadow: var(--clr-soft-shadow);
    text-align: center;
}
#welcome-message h1 { font-size: 2rem; margin: 0 0 10px; font-weight: 700; }
#close-welcome-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    background: none; border: none; color: var(--clr-text-muted); cursor: pointer; padding: 5px; transition: color .18s;
}
#close-welcome-btn:hover { color: var(--clr-accent); }
/* Floating panels */
.floating-panel{position:absolute;padding:22px;border-radius:var(--border-radius);z-index:15;background:var(--clr-panel);border:1px solid var(--clr-border);backdrop-filter: blur(calc(var(--blur-strength) * 1.2));box-shadow:var(--clr-panel-shadow);opacity:0;visibility:hidden;transform:scale(.95) translateY(10px);transition:opacity .3s ease,transform .3s ease,box-shadow .24s}
.floating-panel.active{opacity:1;visibility:visible;transform:scale(1)}
.panel-handle{display:flex;justify-content:space-between;align-items:center;padding-bottom:12px;margin-bottom:12px;border-bottom:1px solid var(--clr-border);cursor:grab;user-select:none}
.floating-panel:active .panel-handle{cursor:grabbing}
.panel-handle h2,.panel-handle h3{margin:0;font-size:1.15rem;font-weight:700}

/* close button */
.close-panel,.close-modal-btn{background:none;border:none;color:var(--clr-text-muted);cursor:pointer;padding:5px;transition:color .18s, transform .18s}
.close-panel:hover,.close-modal-btn:hover{color:var(--clr-accent); transform: scale(1.1);}

/* Micro-interacción de clic para botones */
.action-btn:active, .close-panel:active, .close-modal-btn:active {
    transform: scale(0.95);
    transition-duration: 0.1s;
}

/* Buttons general */
.action-btn{
    padding:8px 15px;border-radius:10px;font-size:.9rem;font-weight:600;cursor:pointer;transition:all .2s;
    display:inline-flex;align-items:center;gap:8px;justify-content:center;
}
.primary-btn{background:var(--clr-primary);color:#fff;border:none;box-shadow:0 6px 16px rgba(88,130,250,0.3)}
.primary-btn:hover{background:color-mix(in srgb, var(--clr-primary) 85%, black);box-shadow:0 8px 20px rgba(88,130,250,0.4)}
.secondary-btn{background:var(--clr-hover);color:var(--clr-text);border:1px solid var(--clr-border)}
.secondary-btn:hover{background:var(--clr-primary);color:#fff;border-color:var(--clr-primary)}

.danger-btn { background-color: var(--clr-accent); color: #fff; border: none; }
.danger-btn:hover { background: color-mix(in srgb, var(--clr-accent) 85%, black); }


/* Timer Panel */
.timer-display{font-size:4.5rem;font-weight:700;text-align:center;margin:20px 0;line-height:1}
.timer-controls{display:flex;justify-content:center;align-items:center;gap:10px;margin-bottom:20px}
.timer-controls input{width:60px;padding:8px;border:1px solid var(--clr-border);border-radius:8px;background:var(--clr-hover);color:var(--clr-text);text-align:center}
.timer-actions{display:flex;justify-content:center;gap:15px}
.timer-actions .primary-btn[aria-pressed="true"]{background:var(--clr-accent);box-shadow:0 6px 16px rgba(232,76,60,0.3)}
.timer-actions .primary-btn[aria-pressed="true"]:hover{background:color-mix(in srgb, var(--clr-accent) 85%, black)}

/* Task Panel */
.task-input-group{display:flex;gap:10px;margin-bottom:15px}
#new-task-input{flex-grow:1;padding:10px;border-radius:8px;border:1px solid var(--clr-border);background:var(--clr-hover);color:var(--clr-text)}
#task-list{list-style:none;padding:0;margin:0;max-height:250px;overflow:auto}
.task-item{display:flex;align-items:center;padding:10px 0;border-bottom:1px dotted var(--clr-border); animation: task-fade-in 0.4s ease forwards;}
.task-item:last-child{border-bottom:none}
.task-item input[type="checkbox"]{margin-right:10px;cursor:pointer}
.task-text{flex-grow:1;font-size:.95rem}
.task-item.fade-out { animation: task-fade-out 0.4s ease forwards; }

@keyframes task-fade-in {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
@keyframes task-fade-out {
    from { opacity: 1; transform: scale(1); }
    to { opacity: 0; transform: scale(0.95); }
}

.task-item.completed .task-text{text-decoration:line-through;color:var(--clr-text-muted)}
.delete-task-btn{background:none;border:none;color:var(--clr-accent);cursor:pointer;padding:5px;opacity:.8;transition:opacity .15s}
.delete-task-btn:hover{opacity:1}

/* Notes Panel */
.notes-toolbar {
    display: flex;
    gap: 8px;
    margin-bottom: 12px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--clr-border);
    flex-wrap: wrap; /* Permite que los botones se envuelvan en lugar de desbordarse */
}
.format-btn {
    background: var(--clr-hover);
    border: 1px solid var(--clr-border);
    color: var(--clr-text-muted);
    width: 34px;
    height: 34px;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all .2s;
}
.format-btn:hover {
    background: var(--clr-primary);
    color: #fff;
    border-color: var(--clr-primary);
}

/* --- Estilos para el nuevo dropdown de formato (tamaño de letra) --- */
.format-dropdown-container {
    position: relative;
}

/* Ajuste para el botón que ahora contiene texto y un icono */
#notes-fontsize-toggle {
    width: auto; /* Ancho automático para acomodar el texto */
    padding: 0 10px;
    gap: 6px;
}

#notes-fontsize-toggle svg {
    transition: transform 0.2s ease;
}

.format-dropdown-menu {
    position: absolute;
    top: calc(100% + 5px);
    left: 0;
    background: var(--clr-panel);
    border: 1px solid var(--clr-border);
    border-radius: 10px;
    padding: 6px;
    min-width: 150px;
    box-shadow: var(--clr-soft-shadow);
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all .2s ease;
    z-index: 20; /* Asegurar que esté por encima de otros elementos */
}

.format-dropdown-menu.open {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.format-dropdown-item { display: block; width: 100%; text-align: left; padding: 8px 12px; border-radius: 6px; background: none; border: none; color: var(--clr-text); cursor: pointer; transition: background .15s; }
.format-dropdown-item:hover, .format-dropdown-item.active { background: var(--clr-hover); color: var(--clr-primary); }

/* Ajustes para que el panel de notas sea flexible y el contenido se expanda */
#content-notes {
    display: flex;
    flex-direction: column;
}
#content-notes .panel-content {
    flex-grow: 1; /* Permite que el contenedor del editor crezca */
}

/* --- Estilos para el panel de Media con Pestañas --- */
.media-tabs {
    display: flex;
    border-bottom: 1px solid var(--clr-border);
    margin-bottom: 15px;
}
.media-tab-btn {
    padding: 10px 15px;
    background: none;
    border: none;
    color: var(--clr-text-muted);
    cursor: pointer;
    font-weight: 600;
    position: relative;
    transition: color .2s;
}
.media-tab-btn:hover {
    color: var(--clr-text);
}
.media-tab-btn.active {
    color: var(--clr-primary);
}
.media-tab-btn.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--clr-primary);
}
.media-tab-content {
    display: none;
}
.media-tab-content.active {
    display: block;
}

/* Estilos para el reproductor de archivos locales */
.local-player-display { text-align: center; }
#local-player-track-title { font-weight: 600; font-size: 1rem; display: block; margin-bottom: 15px; }
.local-player-controls { display: flex; justify-content: center; align-items: center; gap: 15px; margin-bottom: 15px; }
.media-control-btn{width:50px;height:50px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .18s;padding:0}
.media-control-btn.large{width:65px;height:65px}
.local-player-volume { display: flex; align-items: center; justify-content: center; gap: 10px; color: var(--clr-text-muted); }
#local-player-volume-slider { width: 120px; }

.local-playlist {
    list-style: none;
    padding: 0;
    margin-top: 15px;
    max-height: 150px;
    overflow-y: auto;
}

/* Scrollbars estilizadas para la lista de reproducción local y la lista de sonidos */
.local-playlist, #sound-list-container {
    scrollbar-width: thin; /* Firefox */
    scrollbar-color: rgba(88,130,250,0.9) transparent; /* Firefox: thumb then track */
}

/* WebKit (Chrome, Edge, Safari) */
.local-playlist::-webkit-scrollbar,
#sound-list-container::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}

.local-playlist::-webkit-scrollbar-track,
#sound-list-container::-webkit-scrollbar-track {
    background: transparent;
    border-radius: 10px;
}

.local-playlist::-webkit-scrollbar-thumb,
#sound-list-container::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, rgba(88,130,250,0.95), rgba(88,130,250,0.8));
    border-radius: 10px;
    border: 2px solid var(--clr-panel); /* crea un pequeño margen para integrarse con el panel */
    box-shadow: 0 2px 8px rgba(0,0,0,0.12);
}

.local-playlist::-webkit-scrollbar-thumb:hover,
#sound-list-container::-webkit-scrollbar-thumb:hover {
    transform: scale(1.03);
    opacity: 0.95;
}

/* Pequeña mejora visual para el área de scroll cuando está activa (acorde al tema) */
.local-playlist:focus,
#sound-list-container:focus {
    outline: none;
}
.playlist-item {
    padding: 10px;
    border-radius: 8px;
    cursor: pointer;
    transition: background .2s;
    font-size: 0.9rem;
}
.playlist-item:hover { background: var(--clr-hover); }
.playlist-item.playing { background: var(--clr-hover); color: var(--clr-primary); font-weight: 600; }

/* Estilos para el botón de eliminar en la lista de reproducción y sonidos */
.playlist-item, .sound-info-group {
    position: relative; /* Necesario para posicionar el botón de borrado */
}

.playlist-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.playlist-track-name {
    flex-grow: 1;
    cursor: pointer;
}

.delete-item-btn {
    background: none; border: none; color: var(--clr-accent); cursor: pointer; padding: 5px;
    opacity: 0; /* Oculto por defecto */
    transition: opacity 0.2s ease;
}

.playlist-item:hover .delete-item-btn,
.sound-item:hover .delete-item-btn {
    opacity: 1; /* Visible al pasar el ratón */
}

/* --- Estilos para el modo de eliminación en Media y Sonidos --- */
.is-deleting-sounds .sound-item.user-sound,
.is-deleting-tracks .playlist-item {
    cursor: pointer;
}

/* --- Media Panel (YouTube Player) --- */
.media-url-input-group {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}
.media-url-input-group input {
    flex-grow: 1;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid var(--clr-border);
    background: var(--clr-hover);
    color: var(--clr-text);
}
.youtube-player-container {
    position: relative;
    width: 100%;
    padding-top: 56.25%; /* Proporción 16:9 */
    background: var(--clr-hover);
    border-radius: 10px;
    overflow: hidden;
}
.youtube-player-container iframe,
.youtube-player-container .youtube-placeholder {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
}
.youtube-placeholder { display: flex; align-items: center; justify-content: center; color: var(--clr-text-muted); }

/* Sounds Panel */
.panel-info{font-size:.85rem;color:var(--clr-text-muted);margin-bottom:15px}

/* Hacemos que el panel de sonidos sea un contenedor flex vertical */
#content-sounds {
    display: flex;
    flex-direction: column;
}
#content-sounds .panel-content {
    /* Esto asegura que el contenido interno se organice verticalmente y ocupe toda la altura */
    display: flex;
    flex-direction: column;
    flex-grow: 1; /* Ocupa el espacio restante */
    min-height: 0; /* Soluciona problemas de overflow en contenedores flex */
}

/* La lista de sonidos ahora crece para ocupar el espacio disponible y tiene scroll interno */
#sound-list-container{
    flex-grow: 1; /* Permite que la lista crezca */
    overflow-y: auto; /* Añade scroll si el contenido es muy largo */
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.sound-item{position: relative; display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;background:var(--clr-hover);border:1px solid var(--clr-border); flex-shrink: 0;}

.sound-info-group{display:flex;align-items:center;gap:10px}
.sound-info-group span{font-size:.9rem}
/* Permitir que el grupo de información ocupe el espacio disponible sin forzar el tamaño
    y que el nombre pueda truncarse si es muy largo. Esto evita que los controles de volumen
    se desplacen fuera del viewport o se solapen con la scrollbar. */
.sound-info-group { flex: 1 1 auto; min-width: 0; }
.sound-info-group span { display: block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

/* Botón de play/pause para sonidos individuales */
.sound-toggle-btn {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: var(--clr-hover);
    color: var(--clr-text-muted);
    border: 1px solid var(--clr-border);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all .2s;
    padding: 0;
}
.sound-toggle-btn:hover {
    color: var(--clr-primary);
    border-color: var(--clr-primary);
}
.sound-item.playing .sound-toggle-btn {
    background: var(--clr-primary);
    color: #fff;
    border-color: var(--clr-primary);
}

.volume-control-group {
    display: flex;
    align-items: center;
    gap: 8px;
    visibility: hidden; /* Oculto por defecto */
}
.volume-control-group{display:flex;align-items:center;gap:8px;flex:0 0 auto; margin-left:10px}
.volume-control-group svg{width:16px;height:16px;flex:0 0 auto; color:var(--clr-text-muted)}

/* --- CIRUGÍA: Ajuste de Barras de Volumen (Sonidos Ambientales) --- */

/* El riel (La barra en sí) */
#content-sounds input[type="range"] {
    -webkit-appearance: none; 
    width: 140px;             /* Mantenemos el ancho que tenías originalmente */
    flex: 1 1 auto;           /* Para que se ajuste bien en el contenedor flex */
    max-width: 45%;
    height: 6px;              /* Grosor de la barra */
    background: var(--clr-border); /* Usamos la variable de borde (gris suave/oscuro según tema) */
    border-radius: 5px;       
    outline: none;
    margin: 0;                /* Quitamos margen extra porque ya está en un grupo flex */
    cursor: pointer;
    transition: background 0.3s;
}

/*  El "Thumb" (La bolita controladora) - Chrome, Safari, Edge */
#content-sounds input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 16px;              /* Tamaño un poco más sutil para tu UI */
    height: 16px;             
    background: var(--clr-primary); /* ¡Usa el color AZUL (o el del tema) actual! */
    border-radius: 50%;       
    border: 2px solid #fff;   
    box-shadow: 0 2px 4px rgba(0,0,0,0.2); 
    transition: transform 0.2s ease, background 0.2s;
    margin-top: -5px;         /* Centrado vertical ajustado para height 6px */
}

/* Efecto al pasar el mouse por encima de la bolita */
#content-sounds input[type="range"]::-webkit-slider-thumb:hover {
    transform: scale(1.3);    /* Efecto pop */
    background: var(--clr-accent); /* Cambia a color de acento al tocarlo */
}

/*  El "Thumb" para Firefox */
#content-sounds input[type="range"]::-moz-range-thumb {
    width: 16px;
    height: 16px;
    background: var(--clr-primary);
    border: 2px solid #fff;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    transition: transform 0.2s ease;
}

/* Ajuste Responsive (mantenemos tu lógica original para móviles) */
@media (max-width:900px){
    #content-sounds input[type="range"] {
        width: 90px;
        max-width: 40%;
    }
}

/* Asegurar que el control de volumen se vea bien en pantallas pequeñas */
@media (max-width:900px){
    .volume-control-group .volume-slider{width:90px;max-width:40%}
}

/* Estilos para el icono unificado de bocina */
.speaker-icon { display: inline-block; vertical-align: middle; color: var(--clr-text-muted); }
.speaker-icon polygon, .speaker-icon path { stroke: currentColor; fill: none; }

/* Cuando el sonido está activo, colorear la bocina y las ondas */
.sound-item.playing .speaker-icon { color: var(--clr-primary); }

/* Asegurar que el icono no aparezca 'partido' visualmente: eliminar gaps inesperados */
.speaker-icon { stroke-linecap: round; stroke-linejoin: round; }

/* Calendar Panel */
.calendar-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
.calendar-actions {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 15px;
}
.month-year-display{text-align:center}
#calendar-day-name{font-size:.85rem;color:var(--clr-primary);display:block;margin-bottom:-5px}
.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:5px;text-align:center}
.day{padding:10px;border-radius:8px;font-weight:500;cursor:pointer;transition:background .12s;position: relative;}
.day.header{font-weight:700;cursor:default;color:var(--clr-text-muted)}
.day:not(.header):not(.current):hover{background:var(--clr-hover)}
.day.current{background:var(--clr-primary);color:#fff;box-shadow:0 6px 18px rgba(88,130,250,0.18)}
.day.event::after{ content:''; width:6px; height:6px; background:var(--clr-accent); border-radius:50%; position:absolute; bottom:4px; left:50%; transform:translateX(-50%); }

/* Schedule modal */
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:flex;justify-content:center;align-items:center;z-index:100;opacity:0;visibility:hidden;transition:opacity .3s}
.modal.active{opacity:1;visibility:visible}
.modal-content{background:var(--clr-panel);padding:25px;border-radius:var(--border-radius);box-shadow:var(--clr-panel-shadow);width:90%;max-width:500px;transform:scale(.95);transition:transform .3s}
.modal.active .modal-content{transform:scale(1)}
.modal-header{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--clr-border);padding-bottom:15px;margin-bottom:15px}
.modal-header h3{margin:0;font-size:1.2rem}
#new-event-text{flex-grow:1;padding:10px;border-radius:8px;border:1px solid var(--clr-border);background:var(--clr-hover);color:var(--clr-text)}
.event-input-group{display:flex;gap:10px;align-items:center}

.modal-actions {
    display: flex;
    gap: 10px;
}

#new-event-text{width:100%;min-height:100px;padding:10px;border-radius:8px;border:1px solid var(--clr-border);background:var(--clr-hover);color:var(--clr-text);resize:vertical}
#event-list{margin-top:12px;padding-top:8px;border-top:1px solid var(--clr-border);max-height:150px;overflow:auto}
.event-item{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px dotted var(--clr-border)}
.event-item:last-child{border-bottom:none}

/* Credits Modal */
.credits-modal-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}
.credit-card {
    background: var(--clr-hover);
    border: 1px solid var(--clr-border);
    border-radius: var(--border-radius);
    padding: 20px;
    display: flex;
    flex-direction: column;
}
.credit-card.placeholder {
    align-items: center;
    justify-content: center;
    color: var(--clr-text-muted);
    border-style: dashed;
}
.credit-name { font-weight: 700; font-size: 1.1rem; color: var(--clr-text); }
.credit-role { font-weight: 600; font-size: 0.9rem; color: var(--clr-primary); margin: 4px 0 12px; }
.credit-description { font-size: 0.9rem; color: var(--clr-text-muted); margin: 0 0 12px; line-height: 1.5; flex-grow: 1; }
.credit-email { font-size: 0.9rem; color: var(--clr-primary); text-decoration: none; font-weight: 500; }
.credit-email:hover { text-decoration: underline; }

/* Responsive */
@media (max-width:900px){
    .zen-interface{grid-template-columns:64px 1fr}
    .floating-panel{width:300px}
}
@media (max-width:600px){
    .floating-panel{position:fixed;left:12px;right:12px;top:90px;width:auto}
    .sidebar{display:none}
}

/* Sol y luna-Iconos */

#theme-toggle {
    position: relative;
    width: 50px;
    height: 50px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
}

/* --- Lógica del nuevo Icono de Tema (Sol/Luna) --- */
.icon-toggle {
    position: absolute;
    width: 24px;
    height: 24px;
    /* Transición para la animación de fade y rotación */
    transition: opacity 0.35s ease, transform 0.35s ease, color 0.35s ease;
}

/* Por defecto, si el tema es 'light' */
[data-theme="light"] #moon-icon {
    opacity: 1;
    transform: rotate(0deg) scale(1);
    color: var(--clr-text-muted); /* Color de la luna en modo claro */
}
[data-theme="light"] #sun-icon {
    opacity: 0;
    transform: rotate(180deg) scale(0.5); /* Icono de sol oculto y rotado */
}

/* Cuando el tema es 'dark' */
[data-theme="dark"] #moon-icon {
    opacity: 0;
    transform: rotate(-180deg) scale(0.5); /* Icono de luna oculto y rotado */
}
[data-theme="dark"] #sun-icon {
    opacity: 1;
    transform: rotate(0deg) scale(1);
    color: #ffda73; /* Color del sol en modo oscuro (o el que desees) */
}

/* Asegurar que el hover afecte a los iconos */
#theme-toggle:hover .icon-toggle {
    /* Mantenemos el efecto de hover */
    transform: scale(1.12) !important;
}

.calendar-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding: 0 10px; /* Un poco de padding horizontal */
}


/* Header date: single line showing weekday, day, month and year */
#calendar-full-date {
    font-size: 1.05em;
    font-weight: 700;
    color: var(--clr-text);
    text-align: center;
    margin: 0;
}

/* Estilo para mostrar el día completo encima del calendario (subtexto) */
.calendar-day-date {
    font-size: 0.95rem;
    color: var(--clr-text-muted);
    font-weight: 600;
    text-transform: capitalize; /* Asegura mayúscula inicial si es necesario */
}

/* Transiciones suaves para el texto de fecha del calendario */
.calendar-day-date {
    opacity: 1;
    transform: translateY(0);
    transition: opacity 0.22s ease, transform 0.22s ease;
}
.calendar-day-date.fade-out {
    opacity: 0;
    transform: translateY(-6px);
}
.calendar-day-date.fade-in {
    opacity: 1;
    transform: translateY(0);
}

.calendar-nav-btn {
    /* Estilo base */
    background: none;
    border: none;
    cursor: pointer;
    width: 36px;
    height: 36px;
    border-radius: 8px; /* Bordes suaves */
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--clr-text-muted); /* Color suave para los iconos */
    transition: background-color 0.2s ease, color 0.2s ease;
    padding: 0;
}

/* Efecto hover */
.calendar-nav-btn:hover {
    background-color: var(--clr-hover); /* El color de hover de tu tema */
    color: var(--clr-primary); /* Color principal al pasar el ratón */
}

/* Color activo/enfocado */
.calendar-nav-btn:focus-visible {
    outline: 2px solid var(--clr-primary);
    outline-offset: 2px;
}

/* Asegurar que los iconos SVG usen el color del botón */
.calendar-nav-btn svg {
    stroke: currentColor;
}

/* Estilo para el input de Minutos de Enfoque (Temporizador) */
.pomodoro-panel input[type="number"] {
    /* Fondo, borde y color acorde al diseño del panel ZenFocus */
    background: var(--clr-panel); 
    border: 1px solid var(--clr-border); 
    color: var(--clr-text);
    
    /* Diseño y tamaño */
    padding: 8px 12px;
    border-radius: 10px; 
    width: 80px; 
    text-align: center;
    font-weight: 600;
    font-size: 1em; /* Asegurar tamaño de fuente */

    /* Quitar flechas por defecto en Firefox */
    appearance: textfield;
    -moz-appearance: textfield; 
    
    /* Opcional: Estilo en foco */
    outline: none;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

/* Quitar flechas en Chrome/Safari/Edge */
.pomodoro-panel input[type="number"]::-webkit-outer-spin-button,
.pomodoro-panel input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

.pomodoro-panel input[type="number"]:focus {
    border-color: var(--clr-primary);
    /* Usar un color transparente para el foco si existe, o usar el primario */
    box-shadow: 0 0 0 2px rgba(88, 130, 250, 0.2); 
}

/* Aplicar el mismo estilo visual al textarea de notas rápidas para coherencia */
/* Estilo para el nuevo div 'contenteditable' de notas */
#quick-notes[contenteditable="true"] {
    background: var(--clr-hover);
    border: 1px solid var(--clr-border);
    color: var(--clr-text);
    padding: 15px;
    border-radius: 10px;
    width: 100%; /* Ocupa todo el ancho del contenedor */
    height: 100%; /* Ocupa toda la altura disponible */
    font-family: 'Poppins', sans-serif;
    font-size: 0.95em;
    line-height: 1.6;
    outline: none;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
    overflow-y: auto;
    resize: none; /* Desactivamos el redimensionador nativo */
}

#quick-notes[contenteditable="true"]:focus {
    border-color: var(--clr-primary);
    box-shadow: 0 0 0 2px rgba(88, 130, 250, 0.2);
}

/* Placeholder para el div contenteditable */
#quick-notes[contenteditable="true"]:empty:before {
    content: attr(data-placeholder);
    color: var(--clr-text-muted);
    pointer-events: none;
    display: block; /* or inline-block */
}

/* Estilo para el texto formateado (negritas y listas) dentro del div de notas */
#quick-notes strong,
#content-notes strong {
    font-weight: 700;
    color: var(--clr-primary); /* Resaltar negritas con el color primario */
}

/* Estilo de lista simple (ya que estamos en un textarea, el formato es limitado) */
#content-notes ul {
    list-style-type: '• ';
    margin-left: 20px;
    padding-left: 0;
}

#quick-notes li,
#content-notes li{
    margin-bottom: 5px;
    padding-left: 5px;
}

/* --- Estilos para la galería de fondos --- */
.background-gallery {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
}

.background-item {
    position: relative;
    border-radius: 10px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.2s ease;
}

.background-item:hover {
    transform: scale(1.05);
    border-color: var(--clr-primary);
}

.background-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.background-name {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0,0,0,0.6);
    color: #fff;
    padding: 8px;
    font-size: 0.8rem;
    text-align: center;
    font-weight: 500;
}

/* --- Estilos para el modo de eliminación de fondos --- */
.selection-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(88, 130, 250, 0.7); /* Color primario con transparencia */
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    opacity: 0;
    transition: opacity 0.2s ease;
    pointer-events: none; /* No interfiere con el hover del item */
}

/* Superposición de selección para sonidos y pistas */
.is-deleting-sounds .sound-item.user-sound:hover .selection-overlay,
.is-deleting-tracks .playlist-item:hover .selection-overlay {
    opacity: 1;
    pointer-events: auto;
}
/* Cuando el body tiene la clase de eliminación, mostramos la superposición en los fondos personalizables */
.is-deleting-bgs .background-item.custom-background:hover .selection-overlay {
    opacity: 1;
    pointer-events: auto; /* Permite hacer clic en la superposición */
}

.is-deleting-bgs .background-item.custom-background {
    cursor: pointer;
}

/* Estilo para el fondo seleccionado para eliminar */
.background-item.selected-for-deletion .selection-overlay {
    opacity: 1;
}

.background-item.selected-for-deletion {
    border-color: var(--clr-accent);
    transform: scale(1.05);
}

/* Estilo para el item seleccionado para eliminar */
.sound-item.selected-for-deletion,
.playlist-item.selected-for-deletion {
    border-color: var(--clr-accent) !important; /* Usamos !important para sobreescribir otros estilos */
    transform: scale(1.02);
}

/* Cambiar el color del botón de eliminar a un estado de confirmación */
#delete-custom-bgs-btn.confirm-delete {
    background-color: #2ecc71; /* Un color verde para confirmar */
}

/* Aplicamos el mismo estilo de confirmación a los nuevos botones */
#delete-custom-sounds-btn.confirm-delete,
#delete-local-tracks-btn.confirm-delete {
    background-color: #2ecc71;
}

/* Botón para eliminar fondos personalizados */
.delete-custom-bg-btn {
    position: absolute;
    top: 5px;
    right: 5px;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: rgba(0,0,0,0.6);
    color: #fff;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    line-height: 1;
    opacity: 0; /* Oculto por defecto */
    transition: opacity 0.2s ease, background 0.2s ease;
}
.background-item:hover .delete-custom-bg-btn {
    opacity: 1; /* Visible al pasar el ratón sobre el item */
}
.delete-custom-bg-btn:hover {
    background: var(--clr-accent);
}

/* ------------------------------------------------ */

/* --- Estilos para el control de redimensionamiento de paneles --- */
.resize-handle {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 16px;
    height: 16px;
    cursor: nwse-resize;
    z-index: 1; /* Asegura que esté sobre el contenido del panel */
    background: transparent;
    /* Opcional: Añadir un indicador visual */
    background-image: linear-gradient(135deg, 
        transparent 0%, transparent 55%, 
        var(--clr-border) 55%, var(--clr-border) 70%, 
        transparent 70%, transparent 85%, 
        var(--clr-border) 85%, var(--clr-border) 100%);
}

/* --- Estilos para la barra de desplazamiento personalizada en Notas Rápidas --- */

/* Para Firefox */
#quick-notes {
    scrollbar-width: thin; /* Barra más delgada */
    scrollbar-color: var(--clr-text-muted) transparent; /* Pulgar y pista */
}

/* Para navegadores WebKit (Chrome, Safari, Edge, etc.) */
#quick-notes::-webkit-scrollbar {
    width: 10px; /* Ancho de la barra de desplazamiento */
}

#quick-notes::-webkit-scrollbar-track {
    background: transparent; /* La pista de la barra será transparente */
    margin: 5px 0; /* Margen vertical para que no toque los bordes superior/inferior */
}

#quick-notes::-webkit-scrollbar-thumb {
    background-color: var(--clr-border); /* Color del pulgar (la parte que se mueve) */
    border-radius: 20px; /* Bordes completamente redondeados */
    border: 2px solid var(--clr-hover); /* Un pequeño borde que coincide con el fondo del input */
}

#quick-notes::-webkit-scrollbar-thumb:hover {
    background-color: var(--clr-text-muted); /* Un color un poco más visible al pasar el ratón */
}

/* --- Estilo para el logo en la Topbar de Paginaprincipal --- */
.topbar-app-logo {
    width: 24px;        /* Tamaño pequeño y discreto */
    height: 24px;
    border-radius: 5px; /* Bordes suaves */
    object-fit: cover;
    margin-right: 8px;  /* Separación con el texto */
}
